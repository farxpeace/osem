<?php $this->load->view('includes/dashlite_header'); ?><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/filepond/4.30.4/filepond.css" integrity="sha512-OwkTbucz29JjQUeii4ZRkjY/E+Xdg4AfffPZICCf98rYKWIHxX87AwwuIQ73rbVrev8goqrKmaXyu+VxyDqr1A==" crossorigin="anonymous" referrerpolicy="no-referrer" /><link href="https://unpkg.com/filepond-plugin-image-edit/dist/filepond-plugin-image-edit.css" rel="stylesheet" /><link href="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.css" rel="stylesheet" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/1.9.0/css/lightgallery.css" /><?php $this->load->view('admin_users/admin_view_user_detail/navbar'); ?><style>    .sweetalert_confirm_submit_ol {        font-size: 14px !important;    }    .sweetalert_confirm_submit_ol li {        margin-bottom: 8px    }</style><div class="row">    <div class="col-6">        <div class="col-12">            <div class="card card-bordered card-full">                <div class="card-inner border-bottom">                    <div class="card-title-group">                        <div class="card-title">                            <h6 class="title">User Detail</h6>                        </div>                    </div>                </div>                <div class="card-inner border-bottom">                    <div class="row mb-3 form-group">                        <label  class="col-3 col-form-label">Username</label>                        <div class="col-9">                            <div class="input-group">                                <input type="text" class="form-control" value="<?php echo $user_detail['uacc_username']; ?>" disabled>                                <div class="input-group-append">                                    <button class="btn btn-outline-primary btn-dim btn_copy_clipboard"><i class="fa-regular fa-copy"></i></button>                                </div>                            </div>                        </div>                    </div>                    <div class="row mb-3 form-group">                        <label  class="col-3 col-form-label">Nickname</label>                        <div class="col-9">                            <div class="input-group">                                <input type="text" class="form-control editable" id="fullname" value="<?php echo $user_profile['fullname']; ?>" required>                                <div class="input-group-append">                                    <button class="btn btn-outline-primary btn-dim btn_copy_clipboard"><i class="fa-regular fa-copy"></i></button>                                </div>                            </div>                        </div>                    </div>                    <div class="row mb-3 form-group">                        <label  class="col-3 col-form-label">Email</label>                        <div class="col-9">                            <div class="input-group">                                <input type="text" class="form-control editable" id="email" value="<?php echo $user_detail['user_profile']['email']; ?>">                                <div class="input-group-append">                                    <button class="btn btn-outline-primary btn-dim btn_copy_clipboard"><i class="fa-regular fa-copy"></i></button>                                </div>                            </div>                        </div>                    </div>                    <div class="row mb-3 form-group">                        <label  class="col-3 col-form-label">Contact Number</label>                        <div class="col-9">                            <div class="input-group">                                <input type="text" class="form-control" id="mobile_number" value="<?php echo $user_profile['mobile_number']; ?>" disabled>                                <div class="input-group-append">                                    <button class="btn btn-outline-primary btn-dim btn_copy_clipboard"><i class="fa-regular fa-copy"></i></button>                                </div>                            </div>                        </div>                    </div>                    <div class="row mb-3 form-group">                        <label  class="col-3 col-form-label">Role</label>                        <div class="col-9">                            <div class="input-group">                                <input type="text" class="form-control" value="<?php echo $user_detail['user_group_detail']['ugrp_name']; ?>" disabled>                                <div class="input-group-append">                                    <button class="btn btn-outline-primary btn-dim btn_copy_clipboard"><i class="fa-regular fa-copy"></i></button>                                </div>                            </div>                        </div>                    </div>                    <div class="row mb-3 form-group">                        <label  class="col-3 col-form-label">Registration Date</label>                        <div class="col-9">                            <div class="input-group">                                <input type="text" class="form-control" value="<?php echo $user_detail['uacc_date_added']; ?>" disabled>                                <div class="input-group-append">                                    <button class="btn btn-outline-primary btn-dim btn_copy_clipboard"><i class="fa-regular fa-copy"></i></button>                                </div>                            </div>                        </div>                    </div>                </div>                <div class="card-inner">                    <a href="javascript: void(0);" onclick="javascript: btn_update_user();" class="btn btn-primary pull-right">Save <i class="fa-regular fa-paper-plane"></i></a>                </div>            </div>        </div>    </div>    <div class="col-6">        <div class="card card-bordered card-full">            <div class="card-inner border-bottom">                <div class="card-title-group">                    <div class="card-title">                        <h6 class="title">Delete User</h6>                    </div>                </div>            </div>            <div class="card-inner form-horizontal border-bottom">                <p>This operation cannot be undone. All user related info won't be deleted from server and database.</p>            </div>            <div class="card-inner">                <a href="javascript: void(0);" onclick="javascript: delete_user();" class="btn btn-danger pull-right">Delete user <i class="fa-regular fa-paper-plane"></i></a>            </div>        </div>    </div></div><pre><?php //print_r($user_detail) ?></pre><?php $this->load->view('includes/dashlite_footer'); ?><script src="https://cdnjs.cloudflare.com/ajax/libs/filepond/4.30.4/filepond.min.js" integrity="sha512-l+50U3iKl0++46sldyNg5mOh27O0OWyWWsU2UnGfIVcxC+fEttAvao0Rns9KclIELHihYJppMWmM5sWof0M7uA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/1.9.0/js/lightgallery-all.js"></script><script>    function btn_update_user(){        blockUI();        $.ajax({            url: '<?php echo base_url(); ?>admin_users/ajax_admin_update_user_details/',            type: 'POST',            dataType: 'json',            data: {                postdata: {                    uacc_id: '<?php echo $user_detail['uacc_id']; ?>',                    fullname: $("#fullname").val(),                    email: $("#email").val()                }            },            success: function(data){                if(data.status == "success"){                    unblockUI();                    let timerInterval                    Swal.fire({                        title: 'Success',                        html: 'Automatically close in <b></b> milliseconds.',                        timer: 2000,                        timerProgressBar: true,                        didOpen: () => {                            Swal.showLoading()                            const b = Swal.getHtmlContainer().querySelector('b')                            timerInterval = setInterval(() => {                                b.textContent = Swal.getTimerLeft()                            }, 100)                        },                        willClose: () => {                            clearInterval(timerInterval)                        }                    }).then((result) => {                        /* Read more about handling dismissals below */                        if (result.dismiss === Swal.DismissReason.timer) {                            console.log('I was closed by the timer')                        }                        window.location.reload();                    })                }else{                    unblockUI();                    var eell = data.errors;                    $.each(eell, function(i,j){                        var el_on_page = $("#"+i).length;                        if (el_on_page){                            $("#"+i).closest('.form-group').addClass('has-error');                            $("#"+i).closest('.form-group').find('.error_message').text(j).show();                        } else {                        }                        SwalDompet.fire({                            icon: 'error',                            title: 'Oops...',                            html: j,                        })                    });                }            }        });    }</script><script type="text/javascript">    var lightGallery;    var lightGallery_consent;    $(function(){        lightGallery = $("#lightgallery").lightGallery({            selector: '.selector_lightgallery'        });        lightGallery_consent = $("#lightgallery_consent").lightGallery({            selector: '.selector_lightgallery_consent'        });        $("#select_mykad_status").on("change", function(){            onchange_select_mykad_status();        })        $('.upload_mykad').change(function() {            $(this).closest('form').submit();            // or $('#uploadFile').submit();        });    })    function onchange_select_mykad_status(){        var mykad_verification_status = $("#select_mykad_status").val();        var selected_text = $("#select_mykad_status option:selected").text();        var html_content = "Change MyKad status to <b>"+selected_text+"</b>";        var nric_number = $("#nric_number").val();        var fullname_as_per_mykad = $("#fullname_as_per_mykad").val();        SwalDompet.fire({            title: 'Are you sure?',            html: html_content,            icon: 'warning',            showCancelButton: true,            confirmButtonText: 'Confirm'        }).then((result) => {            if (result.isConfirmed) {                blockUI();                $.ajax({                    url: '<?php echo base_url(); ?>admin_users/ajax_admin_update_mykad_status/',                    type: 'POST',                    dataType: 'json',                    data: {                        postdata: {                            nric_number: nric_number,                            mykad_verification_status: mykad_verification_status,                            fullname_as_per_mykad: fullname_as_per_mykad,                            uacc_id: '<?php echo $user_detail["uacc_id"] ?>'                        }                    },                    success: function(data){                        if(data.status == "success"){                            unblockUI();                            swalTimer('success',"Success", "Automatically close in <b></b> milliseconds.", 2000).then(                                function(value) {                                    console.log('sdfsdfdsfdsf')                                },                            );                            //window.location.href = "<?php echo base_url(); ?>dealer/simcard_order/my_stocks";                        }else{                            unblockUI();                            var eell = data.errors;                            $.each(eell, function(i,j){                                var el_on_page = $("#"+i).length;                                if (el_on_page){                                    $("#"+i).closest('.form-group').addClass('has-error');                                    $("#"+i).closest('.form-group').find('.error_message').text(j).show();                                } else {                                }                                SwalDompet.fire({                                    icon: 'error',                                    title: 'Oops...',                                    html: j,                                })                            });                        }                    }                });            }        })    }</script><script type="text/javascript">    function delete_user(){        var html_content = "Confirm delete this user ?";        SwalDompet.fire({            title: 'Are you sure?',            html: html_content,            icon: 'warning',            showCancelButton: true,            confirmButtonText: 'Confirm',            showLoaderOnConfirm: true        }).then((result) => {            if (result.isConfirmed) {                blockUI();                $.ajax({                    url: '<?php echo base_url(); ?>admin_users/ajax_admin_delete_user/',                    type: 'POST',                    dataType: 'json',                    data: {                        postdata: {                            uacc_id: '<?php echo $user_detail['uacc_id']; ?>'                        }                    },                    success: function(data){                        if(data.status == "success"){                            unblockUI();                            let timerInterval                            Swal.fire({                                title: 'Success',                                html: 'Automatically close in <b></b> milliseconds.',                                timer: 2000,                                timerProgressBar: true,                                didOpen: () => {                                    Swal.showLoading()                                    const b = Swal.getHtmlContainer().querySelector('b')                                    timerInterval = setInterval(() => {                                        b.textContent = Swal.getTimerLeft()                                    }, 100)                                },                                willClose: () => {                                    clearInterval(timerInterval)                                }                            }).then((result) => {                                /* Read more about handling dismissals below */                                if (result.dismiss === Swal.DismissReason.timer) {                                    console.log('I was closed by the timer')                                }                            })                            window.location.href = "<?php echo base_url(); ?>admin_users/dashlist_list_all_users";                        }else{                            unblockUI();                            var eell = data.errors;                            $.each(eell, function(i,j){                                var el_on_page = $("#"+i).length;                                if (el_on_page){                                    $("#"+i).closest('.form-group').addClass('has-error');                                    $("#"+i).closest('.form-group').find('.error_message').text(j).show();                                } else {                                }                                SwalDompet.fire({                                    icon: 'error',                                    title: 'Oops...',                                    html: j,                                })                            });                        }                    }                });            }        })    }    function admin_edit_user_detail(){        var populate_date = [];        $(".editable").each(function(i, j){            var column_name = $(j).attr("id");            var column_value = $(j).val();            var push_data = {}            push_data[column_name] = column_value;            populate_date.push(push_data)        });        var html_content = "<ol class='sweetalert_confirm_submit_ol'>";        $(populate_date).each(function(i, j){            var key_name = Object.keys(j)[0];            html_content += "<li>";            html_content += key_name+" : ";            html_content += j[key_name]            html_content += "</li>";        });        html_content += "</ol>";        SwalDompet.fire({            title: 'Are you sure?',            html: html_content,            icon: 'warning',            showCancelButton: true,            confirmButtonText: 'Confirm',            showLoaderOnConfirm: true        }).then((result) => {            if (result.isConfirmed) {                blockUI();                $.ajax({                    url: '<?php echo base_url(); ?>admin_users/ajax_admin_update_user_details/',                    type: 'POST',                    dataType: 'json',                    data: {                        postdata: populate_date,                        userId: '<?php echo $user_detail['userId']; ?>'                    },                    success: function(data){                        if(data.status == "success"){                            unblockUI();                            let timerInterval                            Swal.fire({                                title: 'Success',                                html: 'Automatically close in <b></b> milliseconds.',                                timer: 2000,                                timerProgressBar: true,                                didOpen: () => {                                    Swal.showLoading()                                    const b = Swal.getHtmlContainer().querySelector('b')                                    timerInterval = setInterval(() => {                                        b.textContent = Swal.getTimerLeft()                                    }, 100)                                },                                willClose: () => {                                    clearInterval(timerInterval)                                }                            }).then((result) => {                                /* Read more about handling dismissals below */                                if (result.dismiss === Swal.DismissReason.timer) {                                    console.log('I was closed by the timer')                                }                            })                            //window.location.href = "<?php echo base_url(); ?>dealer/simcard_order/my_stocks";                        }else{                            unblockUI();                            var eell = data.errors;                            $.each(eell, function(i,j){                                var el_on_page = $("#"+i).length;                                if (el_on_page){                                    $("#"+i).closest('.form-group').addClass('has-error');                                    $("#"+i).closest('.form-group').find('.error_message').text(j).show();                                } else {                                }                                SwalDompet.fire({                                    icon: 'error',                                    title: 'Oops...',                                    html: j,                                })                            });                        }                    }                });            }        })        console.log(populate_date)    }</script>