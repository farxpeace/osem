<?php $this->load->view('includes/dashlite_header'); ?><?php $this->load->view('admin_product/admin_view_product_detail/navbar'); ?><div class="row">    <div class="col-6">        <div class="card card-bordered">            <div class="card-inner border-bottom">                <div class="card-title-group">                    <div class="card-title">                        <h6 class="title">PRODUCT DETAIL</h6>                    </div>                </div>            </div>            <div class="card-inner border-bottom">                <div class="row mb-3 form-group">                    <label  class="col-3 col-form-label">PRODUCT NAME</label>                    <div class="col-9">                        <div class="input-group">                            <input type="text" class="form-control" id="product_name" value="<?php echo $product_detail['product_name'] ?>">                            <div class="input-group-append">                                <button class="btn btn-outline-primary btn-dim btn_copy_clipboard"><i class="fa-regular fa-copy"></i></button>                            </div>                        </div>                    </div>                </div>                <div class="row mb-3 form-group">                    <label  class="col-3 col-form-label">SKU</label>                    <div class="col-9">                        <div class="input-group">                            <input type="text" class="form-control input-large" id="sku" value="<?php echo $product_detail['sku'] ?>">                            <div class="input-group-append">                                <button class="btn btn-outline-primary btn-dim btn_copy_clipboard"><i class="fa-regular fa-copy"></i></button>                            </div>                        </div>                    </div>                </div>                <div class="row mb-3 form-group">                    <label  class="col-3 col-form-label">CURRENT STOCK</label>                    <div class="col-9">                        <div class="input-group">                            <input type="text" class="form-control input-large text_current_stock" id="current_stock" value="<?php echo $product_detail['current_stock'] ?>" disabled="" readonly>                            <div class="input-group-append">                                <button class="btn btn-outline-primary btn-dim btn_copy_clipboard"><i class="fa-regular fa-copy"></i></button>                            </div>                        </div>                    </div>                </div>                <div class="row mb-3 form-group">                    <label  class="col-3 col-form-label">NORMAL PRICE</label>                    <div class="col-9">                        <div class="input-group">                            <div class="input-group-prepend">                                <span class="input-group-text" id="basic-addon1">RM</span>                            </div>                            <input type="text" class="form-control" id="price_normal" value="<?php echo $product_detail['price_normal'] ?>">                            <div class="input-group-append">                                <button class="btn btn-outline-primary btn-dim btn_copy_clipboard"><i class="fa-regular fa-copy"></i></button>                            </div>                        </div>                    </div>                </div>                <div class="row mb-3 form-group">                    <label  class="col-3 col-form-label">MEMBER PRICE</label>                    <div class="col-9">                        <div class="input-group">                            <div class="input-group-prepend">                                <span class="input-group-text" id="basic-addon1">RM</span>                            </div>                            <input type="text" class="form-control" id="price_member" value="<?php echo $product_detail['price_member'] ?>">                            <div class="input-group-append">                                <button class="btn btn-outline-primary btn-dim btn_copy_clipboard"><i class="fa-regular fa-copy"></i></button>                            </div>                        </div>                    </div>                </div>                <div class="row mb-3 form-group">                    <label  class="col-3 col-form-label">CATEGORY</label>                    <div class="col-9">                        <div class="input-group">                            <select class="form-control input-large" id="main_category">                                <?php foreach($this->far_product->list_all_category() as $a => $b){ ?>                                    <option value="<?php echo $b['main_category'] ?>" <?php if($b['main_category'] == $product_detail['main_category']){ echo 'selected=""'; } ?>><?php echo $b['main_category'] ?></option>                                <?php } ?>                            </select>                        </div>                    </div>                </div>                <div class="row mb-3 form-group">                    <label  class="col-3 col-form-label">DESCRIPTION</label>                    <div class="col-9">                        <div class="input-group">                            <textarea class="form-control" id="product_description" rows="3"><?php echo $product_detail['product_description']; ?></textarea>                        </div>                    </div>                </div>            </div>            <div class="card-inner">                <a href="javascript: void(0);" onclick="javascript: btn_update_product();" class="btn btn-primary pull-right">Save <i class="fa-regular fa-paper-plane"></i></a>            </div>        </div>    </div>    <div class="col-md-6">        <div class="portlet box red sale-summary">            <div class="portlet-title">                <div class="caption">                    <i class="fa fa-gift"></i>PRODUCT IMAGE                </div>            </div>            <div class="portlet-body">                <div class="thumbnail">                    <?php if(strlen($product_detail['product_image_fullurl']) > 3){ ?>                        <img src="<?php echo $product_detail['product_image_fullurl']; ?>" alt="100%x200" style="width: 50%; display: block;">                    <?php } ?>                    <div class="caption">                        <div id="msgBox"></div>                        <div id="progressOuter" class="progress progress-striped active" style="display:none;">                            <div id="progressBar" class="progress-bar progress-bar-success"  role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 0%">                            </div>                        </div>                        <button id="uploadBtn" class="btn btn-large btn-primary btn-block" style="width: 100%">Choose File</button>                    </div>                </div>            </div>        </div>    </div></div><div class="row mt-3">    <div class="col-12">        <div class="card card-bordered">            <div class="card-inner border-bottom">                <div class="card-title-group">                    <div class="card-title">                        <h6 class="title">STOCK CONTROL</h6>                    </div>                </div>            </div>            <div class="card-inner-group">                <div class="card-inner">                    <div class="team">                        <div class="team-details" style="max-width: none">                            <div class="card-text">                                <div class="row">                                    <div class="col-4">                                        <span class="h4 fw-500" style="font-size: 1.5rem; font-weight: 700;"><?php echo $this->far_stock->count_stock_in($product_detail['product_id']) ?></span>                                        <span class="sub-text">In</span>                                    </div>                                    <div class="col-4">                                        <span class="h4 fw-500" style="font-size: 1.5rem; font-weight: 700;"><?php echo $this->far_stock->count_available_stock($product_detail['product_id']) ?></span>                                        <span class="sub-text">Available</span>                                    </div>                                    <div class="col-4">                                        <span class="h4 fw-500" style="font-size: 1.5rem; font-weight: 700;"><?php echo $this->far_stock->count_stock_out($product_detail['product_id']) ?></span>                                        <span class="sub-text">Out</span>                                    </div>                                </div>                            </div>                        </div>                        <div class="team-view mt-3">                            <a href="javascript:;" class="btn btn-primary me-2" onclick="open_modal_add_stock();"><i class="fa fa-plus"></i> ADD NEW STOCK </a>                            <a href="javascript:;" class="btn btn-danger" onclick="open_modal_add_stock('deduct');"><i class="fa fa-minus"></i> DEDUCT STOCK </a>                        </div>                    </div>                </div>                <div class="card-inner">                    <table id="example5" class=" nowrap table table-bordered" data-export-title="Export">                        <thead>                        <tr>                            <th>CREATED DATE</th>                            <th>QUANTITY</th>                            <th>REMARKS</th>                            <th>Actions<sup>(s)</sup></th>                        </tr>                        </thead>                    </table>                </div>            </div>        </div>    </div></div><div class="modal fade" id="modal_add_new_stock">    <div class="modal-dialog" role="document">        <div class="modal-content">            <div class="modal-header">                <h5 class="modal-title">ADD NEW STOCK</h5>                <a href="#" class="close" data-bs-dismiss="modal" aria-label="Close">                    <em class="icon ni ni-cross"></em>                </a>            </div>            <div class="modal-body">                <form action="#" class="form-validate is-alter">                    <div class="form-group">                        <label class="form-label" for="add_stock_quantity">QUANTITY</label>                        <div class="form-control-wrap">                            <div class="input-group">                                <div class="input-group-prepend">                                    <span class="input-group-text" id="quantity_indicator_positive_negative">+</span>                                </div>                                <input type="text" class="form-control" id="add_stock_quantity" required>                                <div class="form-text-hint">                                    <span class="overline-title">PIECES</span>                                </div>                            </div>                        </div>                    </div>                    <div class="form-group">                        <label class="form-label" for="add_stock_quantity">REMARKS</label>                        <div class="form-control-wrap">                            <input type="text" class="form-control" id="add_stock_remarks" required>                        </div>                    </div>                </form>            </div>            <div class="modal-footer bg-light">                <input type="hidden" id="quantity_negative_positive">                <button type="button" onclick="javascript: btn_click_add_new_stock_list();" class="btn btn-lg btn-primary pull-right">SUBMIT</button>            </div>        </div>    </div></div><?php $this->load->view('includes/dashlite_footer'); ?><script src="https://www.lpology.com/code/ajaxuploader/SimpleAjaxUploader.js"></script><script type="text/javascript">    function open_modal_add_stock(type){        $("#modal_add_new_stock .modal-title").text("ADD NEW STOCK")        $("#quantity_indicator_positive_negative").text("+")        $("#quantity_negative_positive").val("positive")        if(type == 'deduct'){            $("#modal_add_new_stock .modal-title").text("DEDUCT STOCK");            $("#quantity_indicator_positive_negative").text("-");            $("#quantity_negative_positive").val("negative")        }        $('#modal_add_new_stock').modal("show")    }</script><script type="text/javascript">    var datatable_el;    var datatable_el1    $(function(){        datatable_el1 = NioApp.DataTable('#example5', {            "processing": true,            "serverSide": true,            "ajax": {                "url": "<?php echo base_url(); ?>admin_product/ajax_datatable_admin_list_all_stock_list",                "type": "POST",                "data": {                    postdata: {                        product_id: '<?php echo $product_detail['product_id'] ?>'                    }                }            },            "lengthMenu": [[10, 50, 100, -1], [10, 50, 100, "All"]],            responsive: {                details: true            },            buttons: ['copy', 'excel', 'csv', 'pdf'],            "search": {                "search": "<?php echo $this->input->get('dt_search_query') ?>"            },            "order": [0, 'desc'],            "columns": [                { "data": "create_dttm", "searchable": "true" },                { "data": "quantity", "searchable": "true" },                { "data": "remarks", "searchable": "true" },                { "data": "product_id", "searchable": "false", "render": function ( data, type, row ) {                        html = "";                        //html += '<a href="javascript: void(0);" onclick="javascript: quick_delete(\''+row.product_id+'\');" class="btn btn-sm red"><i class="fa fa-times"></i> DELETE</a>';                        //html += '<a href="<?php echo base_url(); ?>admin_product/admin_view_product_detail/?page=product_detail&product_id='+row.product_id+'" class="btn btn-sm green"><i class="fa fa-search"></i> VIEW</a>';                        return html;                    } }            ],        });        //document.querySelector('div.toolbar').innerHTML = '<b>Custom tool bar! Text/images etc.</b>';    });    function reload_datatable(){        blockUI();        datatable_el.ajax.reload(function(){            unblockUI();        });    }</script><Script>    function btn_click_add_new_stock_list(){        var error_el;        $(".has-error").removeClass('has-error');        $(".error_message").hide();        var quantity = $("#add_stock_quantity").val();        var quantity_negative_positive = $("#quantity_negative_positive").val();        if(quantity_negative_positive == 'negative'){            quantity = "-"+quantity;        }        SwalDompet.fire({            title: "Confirmation",            html: "Add <b>"+quantity+"</b> pieces to the <?php echo $product_detail['product_name'] ?>",            icon: "warning",            showCancelButton: true,            confirmButtonColor: "#3085d6",            cancelButtonColor: "#d33",            confirmButtonText: "Yes, confirmed!",            cancelButtonText: "Cancel"        }).then((result) => {            if (result.isConfirmed) {                blockUI_secondary();                $.ajax({                    url: '/admin_product/admin_ajax_add_stock_list',                    type: 'POST',                    dataType: 'json',                    data: {                        postdata: {                            product_id: '<?php echo $product_detail['product_id'] ?>',                            quantity: quantity,                            remarks: $("#add_stock_remarks").val(),                        }                    },                    success: function(data){                        unblockUI()                        if(data.status == "success"){                            swalTimer('success',"Stock added", "Automatically close in <b></b> milliseconds.", 2000).then(                                function(value) {                                    window.location.reload()                                },                            );                        }else{                            var eell = data.errors;                            $.each(eell, function(i,j){                                var el_on_page = $("#"+i).length;                                if (el_on_page){                                    $("#"+i).closest('.form-group').addClass('has-error');                                    $("#"+i).closest('.form-group').find('.error_message').text(j).show();                                } else {                                }                                SwalDompet.fire({                                    icon: "error",                                    title: "Oopss..",                                    text: j                                });                            })                        }                    }                })            }        });    }</Script><script>    window.onload = function() {        var btn = document.getElementById('uploadBtn'),            progressBar = document.getElementById('progressBar'),            progressOuter = document.getElementById('progressOuter'),            msgBox = document.getElementById('msgBox');        var uploader = new ss.SimpleUpload({            debug: true,            button: btn,            url: '<?php echo base_url(); ?>admin_product/product_upload/',            name: 'upload',            data: { product_id: '<?php  echo $product_detail['product_id'] ?>' },            multipart: true,            hoverClass: 'hover',            focusClass: 'focus',            responseType: 'json',            startXHR: function() {                progressOuter.style.display = 'block'; // make progress bar visible                this.setProgressBar( progressBar );            },            onSubmit: function() {                msgBox.innerHTML = ''; // empty the message box                btn.innerHTML = 'Uploading...'; // change button text to "Uploading..."            },            onComplete: function( filename, response ) {                console.log(response)                btn.innerHTML = 'Choose Another File';                progressOuter.style.display = 'none'; // hide progress bar when upload is completed                if(response){                    var resData = response.material_attachment_detail;                    blockUI();                    window.location.reload();                    if ( response.status === 'success' ) {                        $(".text_file_attachment").text(resData.client_name)                        msgBox.innerHTML = '<strong>' + escapeTags( resData.client_name ) + '</strong>' + ' successfully uploaded.';                    } else {                        if ( response.msg )  {                            msgBox.innerHTML = escapeTags( response.msg );                        } else {                            msgBox.innerHTML = 'An error occurred and the upload failed.';                        }                    }                }else{                }            },            onError: function() {                progressOuter.style.display = 'none';                msgBox.innerHTML = 'Unable to upload file';            }        });    };    function escapeTags( str ) {        return String( str )            .replace( /&/g, '&amp;' )            .replace( /"/g, '&quot;' )            .replace( /'/g, '&#39;' )            .replace( /</g, '&lt;' )            .replace( />/g, '&gt;' );    }</script><script>    function btn_update_product(){        var error_el;        $(".has-error").removeClass('has-error');        $(".error_message").hide();        var product_name = $("#product_name").val();        var price_normal = $("#price_normal").val();        var price_member = $("#price_member").val();        var main_category = $("#main_category").val();        blockUI_secondary();        $.ajax({            url: '<?php echo base_url(); ?>admin_product/admin_ajax_update_product',            type: 'POST',            dataType: 'json',            data: {                postdata: {                    product_id: '<?php echo $product_detail['product_id']; ?>',                    product_name: product_name,                    price_normal: price_normal,                    price_member: price_member,                    main_category: main_category,                    sku: $("#sku").val(),                    product_description: $("#product_description").val()                }            },            success: function(data){                unblockUI()                if(data.status == "success"){                    swalTimer('success','Success', 'Product update success', 2500).then(                        function(value) {                            window.location.reload();                        },                    );                }else{                    var eell = data.errors;                    $.each(eell, function(i,j){                        var el_on_page = $("#"+i).length;                        if (el_on_page){                            $("#"+i).closest('.form-group').addClass('has-error');                            $("#"+i).closest('.form-group').find('.error_message').text(j).show();                        } else {                            sweetAlert("Oops...", "Something went wrong!", "error");                        }                        Swal.fire({                            icon: "error",                            title: "Oops...",                            text: j,                        });                    })                }            }        })    }</script>